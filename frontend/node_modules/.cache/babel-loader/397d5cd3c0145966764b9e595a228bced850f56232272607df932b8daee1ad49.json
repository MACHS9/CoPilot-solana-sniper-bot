{"ast":null,"code":"var _s = $RefreshSig$();\n// frontend/src/hooks/usePhantom.js\n\nimport { useState, useEffect } from \"react\";\nimport { Connection, PublicKey, Transaction } from \"@solana/web3.js\";\nconst RPC_URL = \"https://api.mainnet-beta.solana.com\"; // لاحقًا سنجعله من backend\nconst connection = new Connection(RPC_URL, \"confirmed\");\nexport default function usePhantom() {\n  _s();\n  const [publicKey, setPublicKey] = useState(null);\n  const [connected, setConnected] = useState(false);\n\n  // -----------------------------\n  // 1) Connect to Phantom\n  // -----------------------------\n  const connect = async () => {\n    try {\n      if (!window.solana) {\n        alert(\"Phantom Wallet not found\");\n        return;\n      }\n      const resp = await window.solana.connect();\n      setPublicKey(resp.publicKey.toString());\n      setConnected(true);\n    } catch (err) {\n      console.error(\"Phantom connect error:\", err);\n    }\n  };\n\n  // -----------------------------\n  // 2) Disconnect\n  // -----------------------------\n  const disconnect = async () => {\n    try {\n      await window.solana.disconnect();\n      setPublicKey(null);\n      setConnected(false);\n    } catch (err) {\n      console.error(\"Phantom disconnect error:\", err);\n    }\n  };\n\n  // -----------------------------\n  // 3) Check connection on load\n  // -----------------------------\n  useEffect(() => {\n    var _window$solana, _window$solana2, _window$solana3;\n    if ((_window$solana = window.solana) !== null && _window$solana !== void 0 && _window$solana.isConnected) {\n      setPublicKey(window.solana.publicKey.toString());\n      setConnected(true);\n    }\n    (_window$solana2 = window.solana) === null || _window$solana2 === void 0 ? void 0 : _window$solana2.on(\"connect\", () => {\n      setPublicKey(window.solana.publicKey.toString());\n      setConnected(true);\n    });\n    (_window$solana3 = window.solana) === null || _window$solana3 === void 0 ? void 0 : _window$solana3.on(\"disconnect\", () => {\n      setPublicKey(null);\n      setConnected(false);\n    });\n    return () => {\n      var _window$solana4, _window$solana5;\n      (_window$solana4 = window.solana) === null || _window$solana4 === void 0 ? void 0 : _window$solana4.removeAllListeners(\"connect\");\n      (_window$solana5 = window.solana) === null || _window$solana5 === void 0 ? void 0 : _window$solana5.removeAllListeners(\"disconnect\");\n    };\n  }, []);\n\n  // -----------------------------\n  // 4) Get SOL Balance\n  // -----------------------------\n  const getBalance = async () => {\n    if (!publicKey) return 0;\n    try {\n      const balance = await connection.getBalance(new PublicKey(publicKey));\n      return balance / 1e9; // تحويل إلى SOL\n    } catch (err) {\n      console.error(\"Balance error:\", err);\n      return 0;\n    }\n  };\n\n  // -----------------------------\n  // 5) Sign Transaction\n  // -----------------------------\n  const signTransaction = async tx => {\n    try {\n      const signed = await window.solana.signTransaction(tx);\n      return signed;\n    } catch (err) {\n      console.error(\"Sign transaction error:\", err);\n      throw err;\n    }\n  };\n\n  // -----------------------------\n  // 6) Sign + Send Transaction\n  // -----------------------------\n  const signAndSend = async tx => {\n    try {\n      const signed = await window.solana.signTransaction(tx);\n      const sig = await connection.sendRawTransaction(signed.serialize());\n      return sig;\n    } catch (err) {\n      console.error(\"Send transaction error:\", err);\n      throw err;\n    }\n  };\n  return {\n    publicKey,\n    connected,\n    connect,\n    disconnect,\n    getBalance,\n    signTransaction,\n    signAndSend\n  };\n}\n_s(usePhantom, \"evQADof7UyePzHdtB/8HVG8k8qA=\");","map":{"version":3,"names":["useState","useEffect","Connection","PublicKey","Transaction","RPC_URL","connection","usePhantom","_s","publicKey","setPublicKey","connected","setConnected","connect","window","solana","alert","resp","toString","err","console","error","disconnect","_window$solana","_window$solana2","_window$solana3","isConnected","on","_window$solana4","_window$solana5","removeAllListeners","getBalance","balance","signTransaction","tx","signed","signAndSend","sig","sendRawTransaction","serialize"],"sources":["C:/Users/user/Desktop/CoPilot solana-sniper-bot/frontend/src/hooks/usePhantom.js"],"sourcesContent":["// frontend/src/hooks/usePhantom.js\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { Connection, PublicKey, Transaction } from \"@solana/web3.js\";\r\n\r\nconst RPC_URL = \"https://api.mainnet-beta.solana.com\"; // لاحقًا سنجعله من backend\r\nconst connection = new Connection(RPC_URL, \"confirmed\");\r\n\r\nexport default function usePhantom() {\r\n  const [publicKey, setPublicKey] = useState(null);\r\n  const [connected, setConnected] = useState(false);\r\n\r\n  // -----------------------------\r\n  // 1) Connect to Phantom\r\n  // -----------------------------\r\n  const connect = async () => {\r\n    try {\r\n      if (!window.solana) {\r\n        alert(\"Phantom Wallet not found\");\r\n        return;\r\n      }\r\n\r\n      const resp = await window.solana.connect();\r\n      setPublicKey(resp.publicKey.toString());\r\n      setConnected(true);\r\n    } catch (err) {\r\n      console.error(\"Phantom connect error:\", err);\r\n    }\r\n  };\r\n\r\n  // -----------------------------\r\n  // 2) Disconnect\r\n  // -----------------------------\r\n  const disconnect = async () => {\r\n    try {\r\n      await window.solana.disconnect();\r\n      setPublicKey(null);\r\n      setConnected(false);\r\n    } catch (err) {\r\n      console.error(\"Phantom disconnect error:\", err);\r\n    }\r\n  };\r\n\r\n  // -----------------------------\r\n  // 3) Check connection on load\r\n  // -----------------------------\r\n  useEffect(() => {\r\n    if (window.solana?.isConnected) {\r\n      setPublicKey(window.solana.publicKey.toString());\r\n      setConnected(true);\r\n    }\r\n\r\n    window.solana?.on(\"connect\", () => {\r\n      setPublicKey(window.solana.publicKey.toString());\r\n      setConnected(true);\r\n    });\r\n\r\n    window.solana?.on(\"disconnect\", () => {\r\n      setPublicKey(null);\r\n      setConnected(false);\r\n    });\r\n\r\n    return () => {\r\n      window.solana?.removeAllListeners(\"connect\");\r\n      window.solana?.removeAllListeners(\"disconnect\");\r\n    };\r\n  }, []);\r\n\r\n  // -----------------------------\r\n  // 4) Get SOL Balance\r\n  // -----------------------------\r\n  const getBalance = async () => {\r\n    if (!publicKey) return 0;\r\n    try {\r\n      const balance = await connection.getBalance(new PublicKey(publicKey));\r\n      return balance / 1e9; // تحويل إلى SOL\r\n    } catch (err) {\r\n      console.error(\"Balance error:\", err);\r\n      return 0;\r\n    }\r\n  };\r\n\r\n  // -----------------------------\r\n  // 5) Sign Transaction\r\n  // -----------------------------\r\n  const signTransaction = async (tx) => {\r\n    try {\r\n      const signed = await window.solana.signTransaction(tx);\r\n      return signed;\r\n    } catch (err) {\r\n      console.error(\"Sign transaction error:\", err);\r\n      throw err;\r\n    }\r\n  };\r\n\r\n  // -----------------------------\r\n  // 6) Sign + Send Transaction\r\n  // -----------------------------\r\n  const signAndSend = async (tx) => {\r\n    try {\r\n      const signed = await window.solana.signTransaction(tx);\r\n      const sig = await connection.sendRawTransaction(signed.serialize());\r\n      return sig;\r\n    } catch (err) {\r\n      console.error(\"Send transaction error:\", err);\r\n      throw err;\r\n    }\r\n  };\r\n\r\n  return {\r\n    publicKey,\r\n    connected,\r\n    connect,\r\n    disconnect,\r\n    getBalance,\r\n    signTransaction,\r\n    signAndSend,\r\n  };\r\n}\r\n"],"mappings":";AAAA;;AAEA,SAASA,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAC3C,SAASC,UAAU,EAAEC,SAAS,EAAEC,WAAW,QAAQ,iBAAiB;AAEpE,MAAMC,OAAO,GAAG,qCAAqC,CAAC,CAAC;AACvD,MAAMC,UAAU,GAAG,IAAIJ,UAAU,CAACG,OAAO,EAAE,WAAW,CAAC;AAEvD,eAAe,SAASE,UAAUA,CAAA,EAAG;EAAAC,EAAA;EACnC,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAGV,QAAQ,CAAC,IAAI,CAAC;EAChD,MAAM,CAACW,SAAS,EAAEC,YAAY,CAAC,GAAGZ,QAAQ,CAAC,KAAK,CAAC;;EAEjD;EACA;EACA;EACA,MAAMa,OAAO,GAAG,MAAAA,CAAA,KAAY;IAC1B,IAAI;MACF,IAAI,CAACC,MAAM,CAACC,MAAM,EAAE;QAClBC,KAAK,CAAC,0BAA0B,CAAC;QACjC;MACF;MAEA,MAAMC,IAAI,GAAG,MAAMH,MAAM,CAACC,MAAM,CAACF,OAAO,CAAC,CAAC;MAC1CH,YAAY,CAACO,IAAI,CAACR,SAAS,CAACS,QAAQ,CAAC,CAAC,CAAC;MACvCN,YAAY,CAAC,IAAI,CAAC;IACpB,CAAC,CAAC,OAAOO,GAAG,EAAE;MACZC,OAAO,CAACC,KAAK,CAAC,wBAAwB,EAAEF,GAAG,CAAC;IAC9C;EACF,CAAC;;EAED;EACA;EACA;EACA,MAAMG,UAAU,GAAG,MAAAA,CAAA,KAAY;IAC7B,IAAI;MACF,MAAMR,MAAM,CAACC,MAAM,CAACO,UAAU,CAAC,CAAC;MAChCZ,YAAY,CAAC,IAAI,CAAC;MAClBE,YAAY,CAAC,KAAK,CAAC;IACrB,CAAC,CAAC,OAAOO,GAAG,EAAE;MACZC,OAAO,CAACC,KAAK,CAAC,2BAA2B,EAAEF,GAAG,CAAC;IACjD;EACF,CAAC;;EAED;EACA;EACA;EACAlB,SAAS,CAAC,MAAM;IAAA,IAAAsB,cAAA,EAAAC,eAAA,EAAAC,eAAA;IACd,KAAAF,cAAA,GAAIT,MAAM,CAACC,MAAM,cAAAQ,cAAA,eAAbA,cAAA,CAAeG,WAAW,EAAE;MAC9BhB,YAAY,CAACI,MAAM,CAACC,MAAM,CAACN,SAAS,CAACS,QAAQ,CAAC,CAAC,CAAC;MAChDN,YAAY,CAAC,IAAI,CAAC;IACpB;IAEA,CAAAY,eAAA,GAAAV,MAAM,CAACC,MAAM,cAAAS,eAAA,uBAAbA,eAAA,CAAeG,EAAE,CAAC,SAAS,EAAE,MAAM;MACjCjB,YAAY,CAACI,MAAM,CAACC,MAAM,CAACN,SAAS,CAACS,QAAQ,CAAC,CAAC,CAAC;MAChDN,YAAY,CAAC,IAAI,CAAC;IACpB,CAAC,CAAC;IAEF,CAAAa,eAAA,GAAAX,MAAM,CAACC,MAAM,cAAAU,eAAA,uBAAbA,eAAA,CAAeE,EAAE,CAAC,YAAY,EAAE,MAAM;MACpCjB,YAAY,CAAC,IAAI,CAAC;MAClBE,YAAY,CAAC,KAAK,CAAC;IACrB,CAAC,CAAC;IAEF,OAAO,MAAM;MAAA,IAAAgB,eAAA,EAAAC,eAAA;MACX,CAAAD,eAAA,GAAAd,MAAM,CAACC,MAAM,cAAAa,eAAA,uBAAbA,eAAA,CAAeE,kBAAkB,CAAC,SAAS,CAAC;MAC5C,CAAAD,eAAA,GAAAf,MAAM,CAACC,MAAM,cAAAc,eAAA,uBAAbA,eAAA,CAAeC,kBAAkB,CAAC,YAAY,CAAC;IACjD,CAAC;EACH,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA;EACA;EACA,MAAMC,UAAU,GAAG,MAAAA,CAAA,KAAY;IAC7B,IAAI,CAACtB,SAAS,EAAE,OAAO,CAAC;IACxB,IAAI;MACF,MAAMuB,OAAO,GAAG,MAAM1B,UAAU,CAACyB,UAAU,CAAC,IAAI5B,SAAS,CAACM,SAAS,CAAC,CAAC;MACrE,OAAOuB,OAAO,GAAG,GAAG,CAAC,CAAC;IACxB,CAAC,CAAC,OAAOb,GAAG,EAAE;MACZC,OAAO,CAACC,KAAK,CAAC,gBAAgB,EAAEF,GAAG,CAAC;MACpC,OAAO,CAAC;IACV;EACF,CAAC;;EAED;EACA;EACA;EACA,MAAMc,eAAe,GAAG,MAAOC,EAAE,IAAK;IACpC,IAAI;MACF,MAAMC,MAAM,GAAG,MAAMrB,MAAM,CAACC,MAAM,CAACkB,eAAe,CAACC,EAAE,CAAC;MACtD,OAAOC,MAAM;IACf,CAAC,CAAC,OAAOhB,GAAG,EAAE;MACZC,OAAO,CAACC,KAAK,CAAC,yBAAyB,EAAEF,GAAG,CAAC;MAC7C,MAAMA,GAAG;IACX;EACF,CAAC;;EAED;EACA;EACA;EACA,MAAMiB,WAAW,GAAG,MAAOF,EAAE,IAAK;IAChC,IAAI;MACF,MAAMC,MAAM,GAAG,MAAMrB,MAAM,CAACC,MAAM,CAACkB,eAAe,CAACC,EAAE,CAAC;MACtD,MAAMG,GAAG,GAAG,MAAM/B,UAAU,CAACgC,kBAAkB,CAACH,MAAM,CAACI,SAAS,CAAC,CAAC,CAAC;MACnE,OAAOF,GAAG;IACZ,CAAC,CAAC,OAAOlB,GAAG,EAAE;MACZC,OAAO,CAACC,KAAK,CAAC,yBAAyB,EAAEF,GAAG,CAAC;MAC7C,MAAMA,GAAG;IACX;EACF,CAAC;EAED,OAAO;IACLV,SAAS;IACTE,SAAS;IACTE,OAAO;IACPS,UAAU;IACVS,UAAU;IACVE,eAAe;IACfG;EACF,CAAC;AACH;AAAC5B,EAAA,CA9GuBD,UAAU","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}